<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-139640266-2","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Agora-cl" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Extending APIs | Agora-cl</title><meta data-react-helmet="true" property="og:url" content="https://agora-cl-docs.bosagora.io/docs/devtools/extending-apis"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Extending APIs | Agora-cl"><meta data-react-helmet="true" name="description" content="Introduction: Agora-cl API and Beacon API"><meta data-react-helmet="true" property="og:description" content="Introduction: Agora-cl API and Beacon API"><link data-react-helmet="true" rel="shortcut icon" href="/img/bosagora-logo.png"><link data-react-helmet="true" rel="canonical" href="https://agora-cl-docs.bosagora.io/docs/devtools/extending-apis"><link data-react-helmet="true" rel="alternate" href="https://agora-cl-docs.bosagora.io/docs/devtools/extending-apis" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://agora-cl-docs.bosagora.io/docs/devtools/extending-apis" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9b7cbe7b.css">
<link rel="preload" href="/assets/js/runtime~main.bf2263fc.js" as="script">
<link rel="preload" href="/assets/js/main.a87cd8b8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/getting-started"><img src="/img/bosagora-logo.png" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/bosagora-logo.png" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Agora-cl Documentation</b></a><a href="https://github.com/zeroone-boa/agora-cl/releases/tag/v3.1.1" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">agora_v3.1.1</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/install/install-with-script">Quick Install</a><a href="https://github.com/zeroone-boa/agora-cl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://t.me/bosagora_eng" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1ZXk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Table of contents</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/install/install-with-script">Quickstart: Run a node</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/prepare-for-merge">Prepare for The Merge</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/security-best-practices">Security best practices</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/agora-cl-usage/parameters">Command-line options</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/monitoring/checking-status">Check node and validator status</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/troubleshooting/issues-errors">Troubleshooting</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced installation guides</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How-tos</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Developer wiki</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contribute/contribution-guidelines">Contribute to Agora-cl&#x27;s codebase</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contribute/golang-principles">Golang principles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reading/golang">Golang resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reading/bazel">About Bazel</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">APIs</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Developer concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devtools/init-state">Initial synchronization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devtools/net-design">Network design</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/devtools/extending-apis">Extending APIs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/architecture-overview">Architecture overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/agora-cl node">Beacon node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/agora-cl-validator-client">Validator client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/validator-lifecycle">Validator lifecycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/optimistic-sync">Optimistic sync</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/validator-deposit-contract">Validator deposit contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/database-backend-boltdb">BoltDB database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/p2p-networking">P2P networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how-agora-cl-works/bls-cryptography">BLS cryptography</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devtools/end-to-end">End-to-end tests</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Misc</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq">Frequently asked questions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/terminology">Glossary</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Extending APIs</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="introduction-agora-cl-api-and-beacon-api"></a>Introduction: Agora-cl API and Beacon API<a class="hash-link" href="#introduction-agora-cl-api-and-beacon-api" title="Direct link to heading">#</a></h2><hr><p>Since Day 1 of the project Agora-cl has been using <a href="https://grpc.io/" target="_blank" rel="noopener noreferrer">gRPC</a> as the API layer for inter-process communication. As an example, all requests from the validator to the Agora node are conducted via gRPC. This technology helped us greatly to make sure our Ethereum client has a well-defined set of APIs, and that we don&#x27;t introduce backwards incompatibility across versions of Agora-cl.</p><p>As time went on, users started asking if it would be possible to have a JSON-over-HTTP API, which users could query for information about the Agora node, the network state etc. Fortunately it is easy to expose HTTP endpoints for gRPC methods using the <a href="https://github.com/grpc-ecosystem/grpc-gateway" target="_blank" rel="noopener noreferrer">grpc-gateway library</a>. This gave birth to a Agora-cl-specific set of APIs, which we will call the Agora-cl API.</p><p>At some point Ethereum researchers, in cooperation with client developer, decided it would be a good idea to have a standard set of HTTP APIs across the whole network. This led to the <a href="https://ethereum.github.io/beacon-APIs/" target="_blank" rel="noopener noreferrer">official Beacon API specification</a>, which we will call the Beacon API.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="part-1-extending-protocol-buffers-and-grpc"></a>Part 1: Extending protocol buffers and gRPC<a class="hash-link" href="#part-1-extending-protocol-buffers-and-grpc" title="Direct link to heading">#</a></h2><hr><p>Extending both the Agora-cl API and the Beacon API requires following the same steps with regards to protocol buffers and gRPC functions. The only difference is that all Agora-cl API code lives in <code>agora-cl</code> folders and Beacon API code lives in <code>eth</code> folders.</p><p>We will now step through the process of creating a new exemplary API endpoint inside the Agora-cl API.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-1-create-protocol-buffer-messages"></a>Step 1: Create protocol buffer messages<a class="hash-link" href="#step-1-create-protocol-buffer-messages" title="Direct link to heading">#</a></h2><p>Navigate to <a href="https://github.com/zeroone-boa/agora-cl/tree/develop/proto/agora-cl/v1alpha1" target="_blank" rel="noopener noreferrer">https://github.com/zeroone-boa/agora-cl/tree/develop/proto/agora-cl/v1alpha1</a> and create a new file called <code>example_messages.proto</code> with the following content:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">syntax = &quot;proto3&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">package ethereum.eth.v1alpha1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">option go_package = &quot;github.com/zeroone-boa/agora-cl/proto/agora-cl/v1alpha1;eth&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message ExampleRequest {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  string s = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  uint64 i = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message ExampleResponse {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  bool b = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Here we defined two messages: <code>ExampleRequest</code> which we will use as the input to our gRPC function, and <code>ExampleResponse</code> which we will use as the output.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-2-create-a-protocol-buffer-service-interface"></a>Step 2: Create a protocol buffer service interface<a class="hash-link" href="#step-2-create-a-protocol-buffer-service-interface" title="Direct link to heading">#</a></h2><p>Create a new file called <code>example_service.proto</code> next to <code>example_messages.proto</code> with the following content:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">syntax = &quot;proto3&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">package ethereum.eth.v1alpha1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import &quot;proto/agora-cl/v1alpha1/example_messages.proto&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import &quot;google/api/annotations.proto&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">option go_package = &quot;github.com/zeroone-boa/agora-cl/proto/agora-cl/v1alpha1;eth&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">service ExampleService {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rpc ExampleFunction(ExampleRequest) returns (ExampleResponse) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    option (google.api.http) = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      get: &quot;/eth/v1alpha1/example/example&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Here we define our <code>ExampleService</code> interface and one function definition. It will accept and return the previously defined messages and be available through the HTTP <code>/eth/v1alpha1/example/example</code> endpoint.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-3-generate-grpc-code"></a>Step 3: Generate gRPC code<a class="hash-link" href="#step-3-generate-grpc-code" title="Direct link to heading">#</a></h2><p>So far we only have protocol buffer definitions for a service and for messages, but we don&#x27;t have any Go code to back up these definitions. Generating everything we need is very easy. The only thing that we have to do is to run one script. Before we do that, though, we need to update the <code>BUILD.bazel</code> file next to our new proto files. Open the bazel file and add the following items to the <code>srcs</code> array of the <code>proto_library</code> rule:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;example_messages.proto&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;example_service.proto&quot;,</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now it&#x27;s time to run the script mentioned before. Assuming we are in Agora-cl&#x27;s top-level directory on a Linux system, we issue the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./hack/update-go-pbs.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At the end of the output we will see all generated files. Among them should be the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">proto/agora-cl/v1alpha1/example_messages.pb.go</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proto/agora-cl/v1alpha1/example_service.pb.go</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proto/agora-cl/v1alpha1/example_messages.pb.gw.go</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proto/agora-cl/v1alpha1/example_service.pb.gw.go</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>pb.go</code> files is the basic gRPC layer and <code>pb.gw.go</code> files are generated by the grpc-gateway library to provide HTTP capabilities to our functions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-4-implement-the-generated-interface"></a>Step 4: Implement the generated interface<a class="hash-link" href="#step-4-implement-the-generated-interface" title="Direct link to heading">#</a></h2><p>Files generated in Step 3 provide all necessary building blocks to write client-side or server-side gRPC functions. In our case the interfaces to implement contain only one function, <code>ExampleFunction</code>. For example, the server-side interface looks as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">type ExampleServiceServer interface {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ExampleFunction(context.Context, *ExampleRequest) (*ExampleResponse, error)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Any type implementing this interface will automatically be able to receive gRPC and HTTP requests. See <a href="/docs/how-agora-cl-works/agora-cl-public-api">this document</a> for an explanation on how to use the API.</p><p>Beacon API must follow the official specification, for which the above steps, although necessary, are not enough. We must introduce another key component: the API Middleware.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="part-2-api-middleware"></a>Part 2: API Middleware<a class="hash-link" href="#part-2-api-middleware" title="Direct link to heading">#</a></h2><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="objective"></a>Objective<a class="hash-link" href="#objective" title="Direct link to heading">#</a></h2><p>Unfortunately grpc-gateway is not extensible enough to allow implementing the Beacon API spec in its entirety. For that reason we built a piece of software called the API Middleware, which is a proxy between an HTTP client and grpc-gateway. The proxy has complete control over the request/response lifecycle and can therefore provide functionality to satisfy both HTTP REST as well as gRPC.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="useful-links"></a>Useful links<a class="hash-link" href="#useful-links" title="Direct link to heading">#</a></h2><ul><li>The middleware: <a href="https://github.com/zeroone-boa/agora-cl/tree/develop/api/gateway/apimiddleware" target="_blank" rel="noopener noreferrer">https://github.com/zeroone-boa/agora-cl/tree/develop/api/gateway/apimiddleware</a></li><li>Usage in the Agora node: <a href="https://github.com/zeroone-boa/agora-cl/tree/develop/beacon-chain/rpc/apimiddleware" target="_blank" rel="noopener noreferrer">https://github.com/zeroone-boa/agora-cl/tree/develop/beacon-chain/rpc/apimiddleware</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-the-middleware"></a>Using the middleware<a class="hash-link" href="#using-the-middleware" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-endpoint"></a>The <code>Endpoint</code><a class="hash-link" href="#the-endpoint" title="Direct link to heading">#</a></h3><p>The central point of the library is the <code>Endpoint</code> struct. It represents a single HTTP endpoint that is supported by the proxy, meaning that requests to this endpoint will be routed through the middleware.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Endpoint is a representation of an API HTTP endpoint that should be proxied by the middleware.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type Endpoint struct {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Path               string          // The path of the HTTP endpoint.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GetResponse        interface{}     // The struct corresponding to the JSON structure used in a GET response.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    PostRequest        interface{}     // The struct corresponding to the JSON structure used in a POST request.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    PostResponse       interface{}     // The struct corresponding to the JSON structure used in a POST response.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    DeleteRequest      interface{}     // The struct corresponding to the JSON structure used in a DELETE request.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    DeleteResponse     interface{}     // The struct corresponding to the JSON structure used in a DELETE response.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RequestURLLiterals []string        // Names of URL parameters that should not be base64-encoded.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RequestQueryParams []QueryParam    // Query parameters of the request.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Err                ErrorJson       // The struct corresponding to the error that should be returned in case of a request failure.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Hooks              HookCollection  // A collection of functions that can be invoked at various stages of the request/response cycle.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CustomHandlers     []CustomHandler // Functions that will be executed instead of the default request/response behaviour.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We will get back to the details of this struct later, but let&#x27;s first take a look at the <code>EndpointFactory</code> interface.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// EndpointFactory is responsible for creating new instances of Endpoint values.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type EndpointFactory interface {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Create(path string) (*Endpoint, error)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Paths() []string</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    IsNil() bool</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>As the name implies, this is where <code>Endpoint</code>s come from. If you want to register an API endpoint, you firstly need to have a factory implementation. In Agora-cl we already have this interface satisfied by the <code>BeaconEndpointFactory</code> struct. We will skip <code>IsNil</code> in this text because it&#x27;s not related to the middleware per se.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">type BeaconEndpointFactory struct {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">func (f *BeaconEndpointFactory) Paths() []string {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // some code here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">func (f *BeaconEndpointFactory) Create(path string) (*apimiddleware.Endpoint, error) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // some code here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This factory will allow us to implement a new Agora node API endpoint. Let&#x27;s say the Beacon API defines this endpoint:</p><blockquote><p>Description: Returns random data based on block root and optional nonce
Method: GET
URL: /eth/v1/beacon/random/{block_id}
Query parameters: nonce (uint)
Example request: /eth/v1/beacon/random/0xcf8e0d4e9587369b2301d0790347320302cc0943d5a1884560367e8208d920f2?nonce=123456</p><p>Response fields: A (hex string, 4 bytes), B (string)
Example response: { &quot;A&quot;: &quot;0x23456789&quot;, &quot;B&quot;: &quot;345678&quot; }</p></blockquote><p>We will also assume that we have already created protocol buffer definitions for the request and the response.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">message RandomRequest {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bytes block_id = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uint64 nonce = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message RandomResponse {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bytes a = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uint64 b = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Armed with this knowledge, let&#x27;s think how our <code>Endpoint</code> should look like step by step:</p><ul><li><code>Path</code> - This is obvious. The path is <code>/eth/v1/beacon/random/{block_id}</code>. We must not include query parameters in the path.</li><li><code>GetResponse</code>- This is a GET request with a response JSON, so we obviously need some representation of the response. So far we don&#x27;t have anything suitable to put in this field.</li><li><code>PostRequest</code> - It&#x27;s not a POST request, so we don&#x27;t care about this field.</li><li><code>PostResponse</code> - Again, it&#x27;s not a POST request. We can skip this.</li><li><code>RequestURLLiterals</code> - Let&#x27;s stop here for a minute. Do we have any URL parameters that we should <strong>not</strong> encode into base64? We have one parameter called <code>{block_id}</code>, and the example request tells us that it needs to be a hex string. gRPC expects base64-encoded data for each <code>bytes</code> field, which means our parameter should <strong>not</strong> be passed literally. This leads us to the conclusion that we don&#x27;t need this field.</li><li><code>RequestQueryParams</code> - We have one query parameter called <code>nonce</code>, therefore we will need to use this field when preparing our endpoint.</li><li><code>Err</code> - The API specification does not tell us to return any custom errors, so we will use a default one, which is provided by the library.</li><li><code>Hooks</code> - For the sake of this example, let&#x27;s say that our gRPC method returns a 32-byte long value for <code>A</code>, but we need only the first 4 bytes. This will require custom logic and we will use a hook to match our needs.</li><li><code>CustomHandlers</code> - We don&#x27;t want to overwrite the whole request-response logic with our custom code. We leave this field alone.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="registering-our-endpoint"></a>Registering our endpoint<a class="hash-link" href="#registering-our-endpoint" title="Direct link to heading">#</a></h3><p>The first thing that has to be done for every endpoint is to add its path to the array inside the factory&#x27;s <code>Paths</code> method. This is very straightforward.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">return []string{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // all other endpoints</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;/eth/v1/beacon/random/{block_id}&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once we have our path registered, we need to tell our factory what <code>Endpoint</code> to return once we hit this path in our proxy middleware. We add a new <code>case</code> statement at the bottom of the factory&#x27;s <code>Create</code> method.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">case &quot;/eth/v1/beacon/random/{block_id}&quot;:</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We don&#x27;t bother with setting the <code>Path</code> and <code>Err</code> fields because the path is filled out automatically at the bottom of <code>Create</code> and the default error is present in the default <code>Endpoint</code> (at the very top of <code>Create</code> a default <code>Endpoint</code> is created, so we only need to amend it). We therefore start with <code>GetResponse</code>. Next to the factory file we have a <code>structs.go</code> file with a lot of structs defined for already existing endpoints. We add a JSON representation of our response.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">type randomResponseJson struct {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    A string `json:&quot;a&quot; hex:&quot;true&quot;`</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    B string `json:&quot;b&quot;`</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note the <code>hex:&quot;true&quot;</code> struct tag. This tells the middleware that a JSON field is a hex string, so that it can transform it between hex and base64. This allows us to use both representations in one request, satisfying both the HTTP specification and the gRPC requirements.</p><p>Once we have our struct defined, we can use it inside the <code>case</code> statement.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">case &quot;/eth/v1/beacon/random/{block_id}&quot;:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint.GetResponse = &amp;randomResponseJson{}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now it&#x27;s time for <code>RequestQueryParams</code>. Looking at already existing endpoints, it&#x27;s not hard to figure out what has to be done here.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">case &quot;/eth/v1/beacon/random/{block_id}&quot;:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint.GetResponse = &amp;randomResponseJson{}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint.RequestQueryParams = []apimiddleware.QueryParam{{Name: &quot;nonce&quot;}}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At this point we can execute the example request <code>/eth/v1/beacon/random/0xcf8e0d4e9587369b2301d0790347320302cc0943d5a1884560367e8208d920f2?nonce=123456</code> and we will get a response. Our new endpoint is working!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="custom-logic"></a>Custom logic<a class="hash-link" href="#custom-logic" title="Direct link to heading">#</a></h3><p>There is one more thing we need to do before we can call it a day. The specification says that the field <code>A</code> must consist of exactly 4 bytes, but grpc-gateway passes 32 bytes into our proxy middleware. To handle this we firstly need to identify which part of the <code>handleApiPath</code> function in <code>api_middleware.go</code> would need to be changed to fit our needs. After some inspection we come to the conclusion that it&#x27;s <code>SerializeMiddlewareResponseIntoJson</code> because this is where the grpc-gateway&#x27;s response is transformed into the JSON sent to the HTTP client. We need to somehow inject our code before the response gets transformed: fetch the response, replace the contents of <code>A</code> by removing everything except the first 4 bytes, and transform it into JSON as usual.</p><p>Let&#x27;s inspect the <code>HookCollection</code> type, which is a part of the <code>Endpoint</code> definition. We see it contains a function field called <code>OnPreSerializeMiddlewareResponseIntoJson</code>, which is exactly what we need. We need to write a function that satisfies the field&#x27;s signature and implements the required logic. Notice the <code>RunDefault</code> return parameter. It tells the middleware whether it should still execute the default code after the <code>Pre</code> function completes. In our case we don&#x27;t have to serialize the response into JSON ourselves, so we want to set this value to <code>true</code> upon successfully returning from the function.</p><p>All in all, <code>prepareA</code> can look something like below (the second return value can be used when we don&#x27;t want to run the default; we can return the JSON directly from here).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">func prepareA(response interface{}) (apimiddleware.RunDefault, []byte, apimiddleware.ErrorJson) (apimiddleware.RunDefault, []byte, apimiddleware.ErrorJson) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // type assert parameter into our response type</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    randomResponse := (...)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // set the new value</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    randomResponse.A = (...)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // run the default</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return true, nil, nil</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>custom_hooks.go</code> contains several examples of such hooks: pre, post, with and without running the default logic.</p><p>After implementing the hook we have to register it inside the factory.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">case &quot;/eth/v1/beacon/random/{block_id}&quot;:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint.GetResponse = &amp;randomResponseJson{}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint.RequestQueryParams = []apimiddleware.QueryParam{{Name: &quot;nonce&quot;}}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint.Hooks = apimiddleware.HookCollection{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        OnPreSerializeMiddlewareResponseIntoJson: prepareA,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>That&#x27;s it!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="a-few-more-things-to-consider"></a>A few more things to consider<a class="hash-link" href="#a-few-more-things-to-consider" title="Direct link to heading">#</a></h2><p>The example above did not cover everything that is possible with the library. There are some other things that may be of interest when creating a new <code>Endpoint</code>:</p><ul><li>Currently only a few hooks are possible to implement. This is to prevent the <code>HookCollection</code> from having a lot of fields with most of them never used. If you need a new pre or post hook, either create a new wrapped version of the middleware function (in case it has no hooks yet) or amend the existing wrapped function (in case it already has either a pre or post hook). See <code>(...)Wrapped</code> in <code>api_middleware.go</code> for examples.</li><li>Instead of implementing single hooks we can replace the whole response/request with one or more custom handlers, which we register in the factory. See <code>custom_handlers.go</code> for examples. This may be tricky to get right, but essentially allows to manipulate the request in any desirable way.</li><li><code>ProcessRequestContainerFields</code>, <code>ProcessMiddlewareResponseFields</code> and <code>process_field.go</code> are responsible for field translations e.g. hex to base64 and vice versa. If you need to process a field in a new way, you will need to register the struct tag and the processing function in one of the aforementioned functions. Notice that this is a global change, but it does not matter as long as you use a new tag. Because none of the existing structs contain this tag, their fields will not be processed in this new way.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/zeroone-boa/agora-cl-docs/edit/master/website/docs/devtools/extending-apis.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/devtools/net-design"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Network design</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/how-agora-cl-works/architecture-overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Architecture overview Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-agora-cl-api-and-beacon-api" class="table-of-contents__link">Introduction: Agora-cl API and Beacon API</a></li><li><a href="#part-1-extending-protocol-buffers-and-grpc" class="table-of-contents__link">Part 1: Extending protocol buffers and gRPC</a></li><li><a href="#step-1-create-protocol-buffer-messages" class="table-of-contents__link">Step 1: Create protocol buffer messages</a></li><li><a href="#step-2-create-a-protocol-buffer-service-interface" class="table-of-contents__link">Step 2: Create a protocol buffer service interface</a></li><li><a href="#step-3-generate-grpc-code" class="table-of-contents__link">Step 3: Generate gRPC code</a></li><li><a href="#step-4-implement-the-generated-interface" class="table-of-contents__link">Step 4: Implement the generated interface</a></li><li><a href="#part-2-api-middleware" class="table-of-contents__link">Part 2: API Middleware</a></li><li><a href="#objective" class="table-of-contents__link">Objective</a></li><li><a href="#useful-links" class="table-of-contents__link">Useful links</a></li><li><a href="#using-the-middleware" class="table-of-contents__link">Using the middleware</a><ul><li><a href="#the-endpoint" class="table-of-contents__link">The <code>Endpoint</code></a></li><li><a href="#registering-our-endpoint" class="table-of-contents__link">Registering our endpoint</a></li><li><a href="#custom-logic" class="table-of-contents__link">Custom logic</a></li></ul></li><li><a href="#a-few-more-things-to-consider" class="table-of-contents__link">A few more things to consider</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_MyFc" href="/docs/getting-started"><img src="/img/Agora-cl.svg" alt="Agora-cl Docs" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/Agora-cl.svg" alt="Agora-cl Docs" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2022 Bosagora, Validator Deposit Contract 0xXXX</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bf2263fc.js"></script>
<script src="/assets/js/main.a87cd8b8.js"></script>
</body>
</html>