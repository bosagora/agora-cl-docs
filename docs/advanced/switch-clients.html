<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-139640266-2","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Agora-cl" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Switch to a new client | Agora-cl</title><meta data-react-helmet="true" property="og:url" content="https://agora-cl-docs.bosagora.io/docs/advanced/switch-clients"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Switch to a new client | Agora-cl"><meta data-react-helmet="true" name="description" content="This document provides guidance on moving from Agora-cl to a new consensus-layer client like Teku, Lighthouse, or Nimbus."><meta data-react-helmet="true" property="og:description" content="This document provides guidance on moving from Agora-cl to a new consensus-layer client like Teku, Lighthouse, or Nimbus."><link data-react-helmet="true" rel="shortcut icon" href="/img/bosagora-logo.png"><link data-react-helmet="true" rel="canonical" href="https://agora-cl-docs.bosagora.io/docs/advanced/switch-clients"><link data-react-helmet="true" rel="alternate" href="https://agora-cl-docs.bosagora.io/docs/advanced/switch-clients" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://agora-cl-docs.bosagora.io/docs/advanced/switch-clients" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9b7cbe7b.css">
<link rel="preload" href="/assets/js/runtime~main.bf2263fc.js" as="script">
<link rel="preload" href="/assets/js/main.a87cd8b8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/getting-started"><img src="/img/bosagora-logo.png" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/bosagora-logo.png" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Agora-cl Documentation</b></a><a href="https://github.com/zeroone-boa/agora-cl/releases/tag/v3.1.1" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">agora_v3.1.1</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/install/install-with-script">Quick Install</a><a href="https://github.com/zeroone-boa/agora-cl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://t.me/bosagora_eng" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1ZXk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Table of contents</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/install/install-with-script">Quickstart: Run a node</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/prepare-for-merge">Prepare for The Merge</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/security-best-practices">Security best practices</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/agora-cl-usage/parameters">Command-line options</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/monitoring/checking-status">Check node and validator status</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/troubleshooting/issues-errors">Troubleshooting</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced installation guides</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">How-tos</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/execution-node/fee-recipient">Configure Fee Recipient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/execution-node/authentication">Configure JWT authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/execution-node/configuring-for-agora-cl">Configure execution node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/agora-cl-usage/staying-up-to-date">Stay up to date</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/agora-cl-usage/checkpoint-sync">Sync from a checkpoint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/agora-cl-usage/slasher">Run a slasher</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/agora-cl_node_api">Run an archival node</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Backups and migrations</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/agora-cl-usage/database-backups">Back up &amp; restore database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wallet/slashing-protection">Import &amp; export slashing protection history</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/migrating-keys">Move to a new machine</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/advanced/switch-clients">Switch to a new client</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Validator and wallet management</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Monitoring, metrics, and alerts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Managing connections</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developer wiki</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Misc</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq">Frequently asked questions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/terminology">Glossary</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Switch to a new client</h1></header><p>This document provides guidance on moving from Agora-cl to a new consensus-layer client like Teku, Lighthouse, or Nimbus.</p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Slashing Prevention</h5></div><div class="admonition-content"><p>The following best practices will help minimize the risk of <a href="/docs/concepts/slashing">slashing</a> while migrating between clients:</p><ol><li>Never run more than a single validator process with the same keys loaded</li><li>Maintain and utilize slashing protection</li><li>Accept downtime as part of a successful migration</li></ol></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-1-sync-the-agora-node"></a>Step 1: Sync the Agora node<a class="hash-link" href="#step-1-sync-the-agora-node" title="Direct link to heading">#</a></h3><p>Regardless of which client you are switching to, the first step of the process will be to sync the Agora node. This may take some time to complete. Some clients offer a feature known as &quot;checkpoint sync&quot; which allows you to sync a node within a few minutes. Without this, the process may take several hours to a few days.</p><p>Installation documentation links for each client can be found below:</p><p>Agora-cl: <a href="https://nimbus.guide/quick-start.html" target="_blank" rel="noopener noreferrer">https://nimbus.guide/quick-start.html</a>
Teku: <a href="https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Installation-Options/Install-Binaries/" target="_blank" rel="noopener noreferrer">https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Installation-Options/Install-Binaries/</a>
Nimbus: <a href="https://nimbus.guide/quick-start.html" target="_blank" rel="noopener noreferrer">https://nimbus.guide/quick-start.html</a>
Lighthouse: <a href="https://lighthouse-book.sigmaprime.io/installation.html" target="_blank" rel="noopener noreferrer">https://lighthouse-book.sigmaprime.io/installation.html</a>
Lodestar: <a href="https://chainsafe.github.io/lodestar/installation/" target="_blank" rel="noopener noreferrer">https://chainsafe.github.io/lodestar/installation/</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-2-stop-and-disable-agora-cl"></a>Step 2: Stop and Disable Agora-cl<a class="hash-link" href="#step-2-stop-and-disable-agora-cl" title="Direct link to heading">#</a></h3><p>Ensuring you stop and disable Agora-cl is critical to avoiding slashing events before proceeding further.</p><p>Disabling Agora-cl prevents it from automatically starting up again after a reboot.</p><p>Remove Agora-cl&#x27;s validator keys as an added protection by following <a href="http://localhost:3000/docs/advanced/migrating-keys#step-5--verification-and-restarting-the-validator-client" target="_blank" rel="noopener noreferrer">these</a> instructions above.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-3-export-slashing-protection-history"></a>Step 3: Export slashing protection history<a class="hash-link" href="#step-3-export-slashing-protection-history" title="Direct link to heading">#</a></h3><p>Ensure that you stop Agora-cl before exporting slashing protection in order to capture all validator actions.</p><p>We have a section dedicated to exporting and importing slashing protection history <a href="/docs/wallet/slashing-protection">here.</a> Follow the steps regarding exporting slashing protection history.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-4-update-port-forwarding"></a>Step 4: Update port forwarding<a class="hash-link" href="#step-4-update-port-forwarding" title="Direct link to heading">#</a></h3><p>This step is not required for nodes which are running on a virtual public cloud, but keep in mind - nodes will be required to run a an execution client locally post merge!</p><p>By default, Agora-cl uses TCP/13000 and UDP/12000. Remove those two rules and replace them with the appropriate port forwards for the client you are switching to. The process will be very similar to the steps laid out <a href="/docs/agora-cl-usage/p2p-host-ip#port-forwarding">here.</a></p><p>Teku, Nimbus, and Lighthouse all use port 9000 for both TCP and UDP.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-5-import-validator-keys"></a>Step 5: Import Validator Keys<a class="hash-link" href="#step-5-import-validator-keys" title="Direct link to heading">#</a></h3><p>To minimise slashing risk, wait until at least 1 full epoch has elapsed between stopping agora-cl and importing your validator keys, approximately 6.5 minutes, before proceeding. The inactivity leak cost is negligible compared to the cost of getting slashed.</p><p>Once that amount of time has passed, import your validator keys into the respective validator client you wish to run.</p><div groupid="importing keys" values="[object Object],[object Object],[object Object],[object Object]"><div value="nim"><p><a href="https://nimbus.guide/migration.html#step-3---import-your-validator-keys-into-nimbus" target="_blank" rel="noopener noreferrer">https://nimbus.guide/migration.html#step-3---import-your-validator-keys-into-nimbus</a></p></div><div value="lit"><p><a href="https://lighthouse-book.sigmaprime.io/validator-import-launchpad.html#1-run-the-lighthouse-account-validator-import-command" target="_blank" rel="noopener noreferrer">https://lighthouse-book.sigmaprime.io/validator-import-launchpad.html#1-run-the-lighthouse-account-validator-import-command</a></p></div><div value="tek"><p><a href="https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Connect/Connect-To-Mainnet/#run-the-validator-and-agora-cl" target="_blank" rel="noopener noreferrer">https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Connect/Connect-To-Mainnet/#run-the-validator-and-agora-cl</a> node-as-a-single-process</p></div><div value="lod"><p><a href="https://chainsafe.github.io/lodestar/usage/key-management/#import-a-validator-keystore-from-deposit-launch-pad" target="_blank" rel="noopener noreferrer">https://chainsafe.github.io/lodestar/usage/key-management/#import-a-validator-keystore-from-deposit-launch-pad</a></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-6-import-slashing-protection-history"></a>Step 6: Import Slashing Protection History<a class="hash-link" href="#step-6-import-slashing-protection-history" title="Direct link to heading">#</a></h3><p>Follow your new clients&#x27; instructions regarding importing slashing protection history.</p><div groupid="importing slashing protection" values="[object Object],[object Object],[object Object],[object Object]"><div value="nim"><p><a href="https://nimbus.guide/migration.html?highlight=import%20slashing#step-4---import-your-slashing-protection-history" target="_blank" rel="noopener noreferrer">https://nimbus.guide/migration.html?highlight=import%20slashing#step-4---import-your-slashing-protection-history</a></p></div><div value="lit"><p><a href="https://lighthouse-book.sigmaprime.io/slashing-protection.html?highlight=import#import-and-export" target="_blank" rel="noopener noreferrer">https://lighthouse-book.sigmaprime.io/slashing-protection.html?highlight=import#import-and-export</a></p></div><div value="tek"><p><a href="https://docs.teku.consensys.net/en/stable/HowTo/Prevent-Slashing/" target="_blank" rel="noopener noreferrer">https://docs.teku.consensys.net/en/stable/HowTo/Prevent-Slashing/</a></p></div><div value="lod"><p><a href="https://chainsafe.github.io/lodestar/reference/cli/#account-validator-slashing-protection" target="_blank" rel="noopener noreferrer">https://chainsafe.github.io/lodestar/reference/cli/#account-validator-slashing-protection</a></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-7-start-the-new-validator"></a>Step 7: Start the New Validator<a class="hash-link" href="#step-7-start-the-new-validator" title="Direct link to heading">#</a></h3><p>Ensure your Agora node is fully synced with the network by checking your clients logs prior to starting your validator. Once it is fully synced, start the validator.</p><p>Search a block explorer like <a href="https://beaconcha.in/" target="_blank" rel="noopener noreferrer">https://beaconcha.in/</a> with your validator&#x27;s public key to confirm that your validator is now active!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/zeroone-boa/agora-cl-docs/edit/master/website/docs/advanced/switch-clients.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/advanced/migrating-keys"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Move to a new machine</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/wallet/deterministic"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Create a Agora-cl wallet Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#step-1-sync-the-agora-node" class="table-of-contents__link">Step 1: Sync the Agora node</a></li><li><a href="#step-2-stop-and-disable-agora-cl" class="table-of-contents__link">Step 2: Stop and Disable Agora-cl</a></li><li><a href="#step-3-export-slashing-protection-history" class="table-of-contents__link">Step 3: Export slashing protection history</a></li><li><a href="#step-4-update-port-forwarding" class="table-of-contents__link">Step 4: Update port forwarding</a></li><li><a href="#step-5-import-validator-keys" class="table-of-contents__link">Step 5: Import Validator Keys</a></li><li><a href="#step-6-import-slashing-protection-history" class="table-of-contents__link">Step 6: Import Slashing Protection History</a></li><li><a href="#step-7-start-the-new-validator" class="table-of-contents__link">Step 7: Start the New Validator</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_MyFc" href="/docs/getting-started"><img src="/img/Agora-cl.svg" alt="Agora-cl Docs" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/Agora-cl.svg" alt="Agora-cl Docs" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2022 Bosagora, Validator Deposit Contract 0xXXX</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bf2263fc.js"></script>
<script src="/assets/js/main.a87cd8b8.js"></script>
</body>
</html>