"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5090],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),g=c(a),m=r,u=g["".concat(s,".").concat(m)]||g[m]||p[m]||o;return a?n.createElement(u,l(l({ref:t},d),{},{components:a})):n.createElement(u,l({ref:t},d))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=g;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},1262:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7294),r=a(2263);const o=function(e){var t=e.children,a=e.fallback;return(0,r.Z)().isClient&&null!=t?n.createElement(n.Fragment,null,t()):a||null}},5505:(e,t,a)=>{a.d(t,{M:()=>o});var n=a(7294),r=a(1262),o=function(e){var t=e.commaDelimitedContributors,a=e.lastVerifiedDateString,o=e.lastVerifiedVersionString,l={Chris:"hewison-chris"},i=function(e){return n.createElement("a",{class:"header-badge",href:"https://github.com/"+l[e]},n.createElement("span",{class:"badge-avatar",style:{backgroundImage:"url('https://avatars.githubusercontent.com/"+l[e]+"')"}}),n.createElement("span",{class:"badge-label"},e))};return n.createElement(r.Z,null,(function(){return n.createElement("div",{class:"header-badges"},null!=t?t.split(",").map(i):null,function(e,t){if(null!=e&&null!=t)return n.createElement("a",{class:"header-badge"},n.createElement("span",{class:"badge-avatar emoji-avatar"},"\u2714\ufe0f"),n.createElement("span",{class:"badge-label"},"Last verified on ",n.createElement("strong",null,e)," using Agora-cl ",t))}(a,o),n.createElement("a",{class:"header-badge",href:"https://github.com/Bosagora/documentation/issues/new?title=Docs update request: "+new URL(window.location.href).pathname+"&body=Source: "+window.location.href+"%0A%0ARequest: (how can we help?)"},n.createElement("span",{class:"badge-avatar emoji-avatar"},"\u270f\ufe0f"),n.createElement("span",{class:"badge-label"},"Request an update")))}))}},1144:(e,t,a)=>{a.d(t,{M:()=>o});var n=a(7294),r=a(1262),o=function(e){return function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e),n.createElement(r.Z,null,(function(){return n.createElement("div",{class:"update-request"},n.createElement("a",{href:"https://https://github.com/zeroone-boa/agora-cl-docs/issues/new?title=Docs update request: "+new URL(window.location.href).pathname+"&body=Source: "+window.location.href+"%0A%0ARequest: (how can we help?)"},"\ud83d\udc3c Request an update"))}))}},4835:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>p,toc:()=>g});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),l=a(5505),i=a(1144),s=["components"],c={id:"remote",title:"Configure a remote signing wallet",sidebar_label:"Configure a remote signing wallet"},d=void 0,p={unversionedId:"wallet/remote",id:"wallet/remote",isDocsHomePage:!1,title:"Configure a remote signing wallet",description:"This content is now deprecated. See Configure Web3Signer for the latest and recommended remote signing guidance.",source:"@site/docs/wallet/remote.md",sourceDirName:"wallet",slug:"/wallet/remote",permalink:"/docs/wallet/remote",editUrl:"https://github.com/zeroone-boa/agora-cl-docs/edit/master/website/docs/wallet/remote.md",version:"current",frontMatter:{id:"remote",title:"Configure a remote signing wallet",sidebar_label:"Configure a remote signing wallet"},sidebar:"docs",previous:{title:"Create a Agora-cl wallet",permalink:"/docs/wallet/deterministic"},next:{title:"Import keys into a Agora-cl wallet",permalink:"/docs/wallet/nondeterministic"}},g=[{value:"Usage",id:"usage",children:[{value:"Wallet creation",id:"wallet-creation",children:[]},{value:"Wallet edit configuration",id:"wallet-edit-configuration",children:[]},{value:"List validator accounts",id:"list-validator-accounts",children:[]}]}],m={toc:g};function u(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)(l.M,{mdxType:"HeaderBadgesWidget"}),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Deprecated Content")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("strong",{parentName:"p"},"This content is now deprecated.")," See ",(0,o.kt)("a",{parentName:"p",href:"/docs/wallet/web3signer"},"Configure Web3Signer")," for the latest and recommended remote signing guidance."))),(0,o.kt)("p",null,"A ",(0,o.kt)("strong",{parentName:"p"},"remote signing wallet")," provides the ability to connect to a remote server to retrieve validating public keys and process signing requests via a secure ",(0,o.kt)("a",{parentName:"p",href:"https://grpc.io"},"gRPC")," connection. You must supply valid TLS certificates for establishing the secure connection to your server. We have created a reference implementation of a remote signer server, maintained as an open source, Apache 2 project on Github ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Bosagora/remote-signer"},"here")," as a starting point"),(0,o.kt)("p",null,"To be compliant with a Agora-cl remote signing wallet, your remote signing server needs to implement the gRPC API specified in Agora-cl ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/zeroone-boa/agora-cl/blob/7fff4ec41165e6581dda352b362d77fc6ca2710d/proto/validator/accounts/v2/keymanager.proto#L12"},"here"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'service RemoteSigner {\n    // ListPublicKeysResponse managed by a remote signer.\n    rpc ListValidatingPublicKeys(google.protobuf.Empty) returns (ListPublicKeysResponse) {\n        option (google.api.http) = {\n            get: "/accounts/v2/remote/accounts"\n        };\n    }\n\n    // Sign a remote request via gRPC.\n    rpc Sign(SignRequest) returns (SignResponse) {\n        option (google.api.http) = {\n            post: "/accounts/v2/remote/sign"\n        };\n    }\n}\n')),(0,o.kt)("p",null,"Remote sign requests are defined by the following protobuf schema"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"// SignRequest is a message type used by a keymanager\n// as part of Agora-cl's accounts implementation.\nmessage SignRequest {\n  // 48 byte public key corresponding to an associated private key\n  // being requested to sign data.\n  bytes public_key = 1;\n\n  // Raw bytes signing root the client is requesting to sign. The client is\n  // expected to determine these raw bytes from the appropriate BLS\n  // signing domain as well as the signing root of the data structure\n  // the bytes represent.\n  bytes signing_root = 2;\n}\n")),(0,o.kt)("p",null,"Remote signing responses will contain a BLS12-381 signature along with the\nstatus of the signing response from the remote server, signifying the\nrequest either failed, was denied, or completed successfully."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"message SignResponse {\n  enum Status {\n    UNKNOWN = 0;\n    SUCCEEDED = 1;\n    DENIED = 2;\n    FAILED = 3;\n  }\n  // BLS12-381 signature for the data specified in the request.\n  bytes signature = 1;\n}\n")),(0,o.kt)("p",null,"A Agora-cl validator client can then connect securely via ",(0,o.kt)("a",{parentName:"p",href:"https://grpc.io"},"gRPC")," to the remote server and perform its validating duties by relying on the server for the information it needs. Most advanced cloud deployments should likely use this approach, as it is the most customizable."),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("h3",{id:"wallet-creation"},"Wallet creation"),(0,o.kt)("p",null,"To create a new remote signing-capable wallet, you will need to prepare TLS certificates to connect securely to your remote gRPC server. Then, you can run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./agora-cl.sh validator wallet create\n")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You will need a TLS client cert, client key, and a Certificate Authority (CA) cert to establish a secure gRPC connection"))),(0,o.kt)("p",null,"Then select ",(0,o.kt)("strong",{parentName:"p"},"Remote")," wallet when prompted. You can also create a wallet ",(0,o.kt)("strong",{parentName:"p"},"non-interactively")," by using the following command line flags, which are also viewable by typing ",(0,o.kt)("inlineCode",{parentName:"p"},"./agora-cl.sh validator wallet create --help"),"."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Flag"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Usage"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--wallet-dir")),(0,o.kt)("td",{parentName:"tr",align:"left"},'Path to a wallet directory (default: "$HOME/AgoraValidators/agora-cl-wallet-v2").')),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--keymanager-kind")),(0,o.kt)("td",{parentName:"tr",align:"left"},'Type of wallet to create, either "direct", "derived, or "remote" (default "derived").')),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--grpc-remote-address")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Host:port of a gRPC server for the remote signer server.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--remote-signer-crt-path")),(0,o.kt)("td",{parentName:"tr",align:"left"},"/path/to/client.crt for establishing a secure, TLS gRPC connection to a remote signer server.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--remote-signer-key-path")),(0,o.kt)("td",{parentName:"tr",align:"left"},"/path/to/client.key for establishing a secure, TLS gRPC connection to a remote signer server.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--remote-signer-ca-crt-path")),(0,o.kt)("td",{parentName:"tr",align:"left"},"/path/to/ca.crt for establishing a secure, TLS gRPC connection to a remote signer server.")))),(0,o.kt)("h3",{id:"wallet-edit-configuration"},"Wallet edit configuration"),(0,o.kt)("p",null,"To edit your existing remote wallet configuration, such as changing the path of your TLS certs or remote address, you can run"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./agora-cl.sh validator wallet-v2 edit-config\n")),(0,o.kt)("p",null,"You can also edit your wallet configuration ",(0,o.kt)("strong",{parentName:"p"},"non-interactively")," by using the following command line flags, which are also viewable by typing ",(0,o.kt)("inlineCode",{parentName:"p"},"./agora-cl.sh validator wallet create --help"),"."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Flag"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Usage"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--wallet-dir")),(0,o.kt)("td",{parentName:"tr",align:"left"},'Path to a wallet directory (default: "$HOME/AgoraValidators/agora-cl-wallet-v2").')),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--grpc-remote-address")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Host:port of a gRPC server for the remote signer server.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--remote-signer-crt-path")),(0,o.kt)("td",{parentName:"tr",align:"left"},"/path/to/client.crt for establishing a secure, TLS gRPC connection to a remote signer server.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--remote-signer-key-path")),(0,o.kt)("td",{parentName:"tr",align:"left"},"/path/to/client.key for establishing a secure, TLS gRPC connection to a remote signer server.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--remote-signer-ca-crt-path")),(0,o.kt)("td",{parentName:"tr",align:"left"},"/path/to/ca.crt for establishing a secure, TLS gRPC connection to a remote signer server.")))),(0,o.kt)("h3",{id:"list-validator-accounts"},"List validator accounts"),(0,o.kt)("p",null,"You can list all validator accounts in your non-HD wallet using the following command"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"./agora-cl.sh validator accounts list\n")),(0,o.kt)("p",null,"Where you'll see the following output"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"[2020-07-27 14:30:13]  INFO accounts: (wallet path) /Users/johndoe/Library/AgoraValidators/agora-cl-wallet-v2\n(keymanager kind) remote signer\n(configuration file path) /Users/johndoe/Library/AgoraValidators/agora-cl-wallet-v2/remote/keymanageropts.json\n\nConfiguration options\nRemote gRPC address: localhost:4000\nClient cert path: /path/to/example-client.crt\nClient key path: /path/to/example.client.key\nCA cert path: /path/to/ca.crt\n\nShowing **1** validator account\n\npersonally-conscious-echidna\n[validating public key] 0x971d780edfe98743f41cdcdba8521548fc343ffcd958e90968c4f1cc5a2e9b6ea11a984397c34c6cc13e9d4e8d14ce1e\n[created at] 16 minutes ago\n")),(0,o.kt)("p",null,"You can view all available options to run the ",(0,o.kt)("inlineCode",{parentName:"p"},"list")," command by typing `./agora-cl.sh validator accounts list --help."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Flag"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Usage"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"--wallet-dir")),(0,o.kt)("td",{parentName:"tr",align:"left"},'Path to a wallet directory (default: "$HOME/AgoraValidators/agora-cl-wallet-v2")')))),(0,o.kt)(i.M,{mdxType:"RequestUpdateWidget"}))}u.isMDXComponent=!0}}]);