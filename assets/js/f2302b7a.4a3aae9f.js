"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5269],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),h=p(a),u=i,m=h["".concat(l,".").concat(u)]||h[u]||d[u]||o;return a?n.createElement(m,r(r({ref:t},c),{},{components:a})):n.createElement(m,r({ref:t},c))}));function u(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var p=2;p<o;p++)r[p]=a[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},1262:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7294),i=a(2263);const o=function(e){var t=e.children,a=e.fallback;return(0,i.Z)().isClient&&null!=t?n.createElement(n.Fragment,null,t()):a||null}},5505:(e,t,a)=>{a.d(t,{M:()=>o});var n=a(7294),i=a(1262),o=function(e){var t=e.commaDelimitedContributors,a=e.lastVerifiedDateString,o=e.lastVerifiedVersionString,r={Chris:"hewison-chris"},s=function(e){return n.createElement("a",{class:"header-badge",href:"https://github.com/"+r[e]},n.createElement("span",{class:"badge-avatar",style:{backgroundImage:"url('https://avatars.githubusercontent.com/"+r[e]+"')"}}),n.createElement("span",{class:"badge-label"},e))};return n.createElement(i.Z,null,(function(){return n.createElement("div",{class:"header-badges"},null!=t?t.split(",").map(s):null,function(e,t){if(null!=e&&null!=t)return n.createElement("a",{class:"header-badge"},n.createElement("span",{class:"badge-avatar emoji-avatar"},"\u2714\ufe0f"),n.createElement("span",{class:"badge-label"},"Last verified on ",n.createElement("strong",null,e)," using Agora-cl ",t))}(a,o),n.createElement("a",{class:"header-badge",href:"https://github.com/Bosagora/documentation/issues/new?title=Docs update request: "+new URL(window.location.href).pathname+"&body=Source: "+window.location.href+"%0A%0ARequest: (how can we help?)"},n.createElement("span",{class:"badge-avatar emoji-avatar"},"\u270f\ufe0f"),n.createElement("span",{class:"badge-label"},"Request an update")))}))}},1144:(e,t,a)=>{a.d(t,{M:()=>o});var n=a(7294),i=a(1262),o=function(e){return function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e),n.createElement(i.Z,null,(function(){return n.createElement("div",{class:"update-request"},n.createElement("a",{href:"https://https://github.com/zeroone-boa/agora-cl-docs/issues/new?title=Docs update request: "+new URL(window.location.href).pathname+"&body=Source: "+window.location.href+"%0A%0ARequest: (how can we help?)"},"\ud83d\udc3c Request an update"))}))}},4435:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>c,default:()=>f,frontMatter:()=>p,metadata:()=>d,toc:()=>h});var n=a(7462),i=a(3366),o=(a(7294),a(3905)),r=a(5505),s=a(1144),l=["components"],p={id:"switch-clients",title:"Switch to a new client",sidebar_label:"Switch to a new client"},c=void 0,d={unversionedId:"advanced/switch-clients",id:"advanced/switch-clients",isDocsHomePage:!1,title:"Switch to a new client",description:"This document provides guidance on moving from Agora-cl to a new consensus-layer client like Teku, Lighthouse, or Nimbus.",source:"@site/docs/advanced/switch-clients.md",sourceDirName:"advanced",slug:"/advanced/switch-clients",permalink:"/docs/advanced/switch-clients",editUrl:"https://github.com/zeroone-boa/agora-cl-docs/edit/master/website/docs/advanced/switch-clients.md",version:"current",frontMatter:{id:"switch-clients",title:"Switch to a new client",sidebar_label:"Switch to a new client"},sidebar:"docs",previous:{title:"Move to a new machine",permalink:"/docs/advanced/migrating-keys"},next:{title:"Create a Agora-cl wallet",permalink:"/docs/wallet/deterministic"}},h=[{value:"Step 1: Sync the Agora node",id:"step-1-sync-the-agora-node",children:[]},{value:"Step 2: Stop and Disable Agora-cl",id:"step-2-stop-and-disable-agora-cl",children:[]},{value:"Step 3: Export slashing protection history",id:"step-3-export-slashing-protection-history",children:[]},{value:"Step 4: Update port forwarding",id:"step-4-update-port-forwarding",children:[]},{value:"Step 5: Import Validator Keys",id:"step-5-import-validator-keys",children:[]},{value:"Step 6: Import Slashing Protection History",id:"step-6-import-slashing-protection-history",children:[]},{value:"Step 7: Start the New Validator",id:"step-7-start-the-new-validator",children:[]}],u=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",t)}},m=u("Tabs"),g=u("TabItem"),k={toc:h};function f(e){var t=e.components,a=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,n.Z)({},k,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)(r.M,{mdxType:"HeaderBadgesWidget"}),(0,o.kt)("p",null,"This document provides guidance on moving from Agora-cl to a new consensus-layer client like Teku, Lighthouse, or Nimbus."),(0,o.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Slashing Prevention")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The following best practices will help minimize the risk of ",(0,o.kt)("a",{parentName:"p",href:"/docs/concepts/slashing"},"slashing")," while migrating between clients:"),(0,o.kt)("ol",{parentName:"div"},(0,o.kt)("li",{parentName:"ol"},"Never run more than a single validator process with the same keys loaded"),(0,o.kt)("li",{parentName:"ol"},"Maintain and utilize slashing protection"),(0,o.kt)("li",{parentName:"ol"},"Accept downtime as part of a successful migration")))),(0,o.kt)("h3",{id:"step-1-sync-the-agora-node"},"Step 1: Sync the Agora node"),(0,o.kt)("p",null,'Regardless of which client you are switching to, the first step of the process will be to sync the Agora node. This may take some time to complete. Some clients offer a feature known as "checkpoint sync" which allows you to sync a node within a few minutes. Without this, the process may take several hours to a few days.'),(0,o.kt)("p",null,"Installation documentation links for each client can be found below:"),(0,o.kt)("p",null,"Agora-cl: ",(0,o.kt)("a",{parentName:"p",href:"https://nimbus.guide/quick-start.html"},"https://nimbus.guide/quick-start.html"),"\nTeku: ",(0,o.kt)("a",{parentName:"p",href:"https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Installation-Options/Install-Binaries/"},"https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Installation-Options/Install-Binaries/"),"\nNimbus: ",(0,o.kt)("a",{parentName:"p",href:"https://nimbus.guide/quick-start.html"},"https://nimbus.guide/quick-start.html"),"\nLighthouse: ",(0,o.kt)("a",{parentName:"p",href:"https://lighthouse-book.sigmaprime.io/installation.html"},"https://lighthouse-book.sigmaprime.io/installation.html"),"\nLodestar: ",(0,o.kt)("a",{parentName:"p",href:"https://chainsafe.github.io/lodestar/installation/"},"https://chainsafe.github.io/lodestar/installation/")),(0,o.kt)("h3",{id:"step-2-stop-and-disable-agora-cl"},"Step 2: Stop and Disable Agora-cl"),(0,o.kt)("p",null,"Ensuring you stop and disable Agora-cl is critical to avoiding slashing events before proceeding further."),(0,o.kt)("p",null,"Disabling Agora-cl prevents it from automatically starting up again after a reboot."),(0,o.kt)("p",null,"Remove Agora-cl's validator keys as an added protection by following ",(0,o.kt)("a",{parentName:"p",href:"/docs/advanced/migrating-keys#step-5--verification-and-restarting-the-validator-client"},"these")," instructions above."),(0,o.kt)("h3",{id:"step-3-export-slashing-protection-history"},"Step 3: Export slashing protection history"),(0,o.kt)("p",null,"Ensure that you stop Agora-cl before exporting slashing protection in order to capture all validator actions."),(0,o.kt)("p",null,"We have a section dedicated to exporting and importing slashing protection history ",(0,o.kt)("a",{parentName:"p",href:"/docs/wallet/slashing-protection"},"here.")," Follow the steps regarding exporting slashing protection history."),(0,o.kt)("h3",{id:"step-4-update-port-forwarding"},"Step 4: Update port forwarding"),(0,o.kt)("p",null,"This step is not required for nodes which are running on a virtual public cloud, but keep in mind - nodes will be required to run a an execution client locally post merge!"),(0,o.kt)("p",null,"By default, Agora-cl uses TCP/13000 and UDP/12000. Remove those two rules and replace them with the appropriate port forwards for the client you are switching to. The process will be very similar to the steps laid out ",(0,o.kt)("a",{parentName:"p",href:"/docs/agora-cl-usage/p2p-host-ip#port-forwarding"},"here.")),(0,o.kt)("p",null,"Teku, Nimbus, and Lighthouse all use port 9000 for both TCP and UDP."),(0,o.kt)("h3",{id:"step-5-import-validator-keys"},"Step 5: Import Validator Keys"),(0,o.kt)("p",null,"To minimise slashing risk, wait until at least 1 full epoch has elapsed between stopping agora-cl and importing your validator keys, approximately 6.5 minutes, before proceeding. The inactivity leak cost is negligible compared to the cost of getting slashed."),(0,o.kt)("p",null,"Once that amount of time has passed, import your validator keys into the respective validator client you wish to run."),(0,o.kt)(m,{groupId:"importing keys",defaultValue:"nim",values:[{label:"Nimbus",value:"nim"},{label:"Lighthouse",value:"lit"},{label:"Teku",value:"tek"},{label:"Lodestar",value:"lod"}],mdxType:"Tabs"},(0,o.kt)(g,{value:"nim",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://nimbus.guide/migration.html#step-3---import-your-validator-keys-into-nimbus"},"https://nimbus.guide/migration.html#step-3---import-your-validator-keys-into-nimbus"))),(0,o.kt)(g,{value:"lit",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://lighthouse-book.sigmaprime.io/validator-import-launchpad.html#1-run-the-lighthouse-account-validator-import-command"},"https://lighthouse-book.sigmaprime.io/validator-import-launchpad.html#1-run-the-lighthouse-account-validator-import-command"))),(0,o.kt)(g,{value:"tek",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Connect/Connect-To-Mainnet/#run-the-validator-and-agora-cl"},"https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Connect/Connect-To-Mainnet/#run-the-validator-and-agora-cl")," node-as-a-single-process")),(0,o.kt)(g,{value:"lod",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://chainsafe.github.io/lodestar/usage/key-management/#import-a-validator-keystore-from-deposit-launch-pad"},"https://chainsafe.github.io/lodestar/usage/key-management/#import-a-validator-keystore-from-deposit-launch-pad")))),(0,o.kt)("h3",{id:"step-6-import-slashing-protection-history"},"Step 6: Import Slashing Protection History"),(0,o.kt)("p",null,"Follow your new clients' instructions regarding importing slashing protection history."),(0,o.kt)(m,{groupId:"importing slashing protection",defaultValue:"nim",values:[{label:"Nimbus",value:"nim"},{label:"Lighthouse",value:"lit"},{label:"Teku",value:"tek"},{label:"Lodestar",value:"lod"}],mdxType:"Tabs"},(0,o.kt)(g,{value:"nim",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://nimbus.guide/migration.html?highlight=import%20slashing#step-4---import-your-slashing-protection-history"},"https://nimbus.guide/migration.html?highlight=import%20slashing#step-4---import-your-slashing-protection-history"))),(0,o.kt)(g,{value:"lit",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://lighthouse-book.sigmaprime.io/slashing-protection.html?highlight=import#import-and-export"},"https://lighthouse-book.sigmaprime.io/slashing-protection.html?highlight=import#import-and-export"))),(0,o.kt)(g,{value:"tek",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.teku.consensys.net/en/stable/HowTo/Prevent-Slashing/"},"https://docs.teku.consensys.net/en/stable/HowTo/Prevent-Slashing/"))),(0,o.kt)(g,{value:"lod",mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://chainsafe.github.io/lodestar/reference/cli/#account-validator-slashing-protection"},"https://chainsafe.github.io/lodestar/reference/cli/#account-validator-slashing-protection")))),(0,o.kt)("h3",{id:"step-7-start-the-new-validator"},"Step 7: Start the New Validator"),(0,o.kt)("p",null,"Ensure your Agora node is fully synced with the network by checking your clients logs prior to starting your validator. Once it is fully synced, start the validator."),(0,o.kt)("p",null,"Search a block explorer like ",(0,o.kt)("a",{parentName:"p",href:"https://beaconcha.in/"},"https://beaconcha.in/")," with your validator's public key to confirm that your validator is now active!"),(0,o.kt)(s.M,{mdxType:"RequestUpdateWidget"}))}f.isMDXComponent=!0}}]);